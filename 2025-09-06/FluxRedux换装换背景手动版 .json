{"last_node_id":112,"last_link_id":252,"nodes":[{"id":7,"type":"CLIPTextEncode","pos":[182.78091430664062,225],"size":[425,180],"flags":{"collapsed":true},"order":13,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":63,"label":"CLIP"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[81,238],"slot_index":0,"label":"条件"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["",true],"color":"#322","bgcolor":"#533"},{"id":8,"type":"VAEDecode","pos":[1626.78076171875,-12],"size":[210,46],"flags":{},"order":25,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":7,"label":"Latent"},{"name":"vae","type":"VAE","link":60,"label":"VAE"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[230],"slot_index":0,"label":"图像"}],"properties":{"Node name for S&R":"VAEDecode"},"widgets_values":[]},{"id":26,"type":"FluxGuidance","pos":[580.781005859375,97],"size":[315,60],"flags":{},"order":16,"mode":0,"inputs":[{"name":"conditioning","type":"CONDITIONING","link":41,"label":"条件"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[116,237],"slot_index":0,"shape":3,"label":"条件"}],"properties":{"Node name for S&R":"FluxGuidance"},"widgets_values":[30]},{"id":32,"type":"VAELoader","pos":[909.781005859375,285],"size":[315,60],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[{"name":"VAE","type":"VAE","links":[60,82,236],"slot_index":0}],"properties":{"Node name for S&R":"VAELoader"},"widgets_values":["ae.sft"]},{"id":38,"type":"InpaintModelConditioning","pos":[948.781005859375,83],"size":[300,140],"flags":{},"order":23,"mode":0,"inputs":[{"name":"positive","type":"CONDITIONING","link":117,"label":"正面条件"},{"name":"negative","type":"CONDITIONING","link":81,"label":"负面条件"},{"name":"vae","type":"VAE","link":82,"label":"VAE"},{"name":"pixels","type":"IMAGE","link":227,"label":"图像"},{"name":"mask","type":"MASK","link":228,"label":"遮罩"}],"outputs":[{"name":"positive","type":"CONDITIONING","links":[77],"slot_index":0,"label":"正面条件"},{"name":"negative","type":"CONDITIONING","links":[78],"slot_index":1,"label":"负面条件"},{"name":"latent","type":"LATENT","links":[88],"slot_index":2,"label":"Latent"}],"properties":{"Node name for S&R":"InpaintModelConditioning"},"widgets_values":[false]},{"id":39,"type":"DifferentialDiffusion","pos":[950.781005859375,-14],"size":[275,26],"flags":{},"order":11,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":85,"label":"模型"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[86],"slot_index":0,"label":"模型"}],"properties":{"Node name for S&R":"DifferentialDiffusion"},"widgets_values":[]},{"id":49,"type":"ImageResize+","pos":[213.6936492919922,-455.3681945800781],"size":[315,220],"flags":{},"order":14,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":106,"label":"图像"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[125],"slot_index":0,"label":"图像"},{"name":"width","type":"INT","links":null,"label":"宽度"},{"name":"height","type":"INT","links":null,"label":"高度"}],"properties":{"Node name for S&R":"ImageResize+"},"widgets_values":[1600,1600,"lanczos","keep proportion","always",0]},{"id":53,"type":"CLIPVisionEncode","pos":[198.53414916992188,281.6104431152344],"size":[290,78],"flags":{},"order":15,"mode":0,"inputs":[{"name":"clip_vision","type":"CLIP_VISION","link":112,"label":"CLIP视觉"},{"name":"image","type":"IMAGE","link":150,"label":"图像"}],"outputs":[{"name":"CLIP_VISION_OUTPUT","type":"CLIP_VISION_OUTPUT","links":[115],"slot_index":0,"label":"CLIP视觉输出"}],"properties":{"Node name for S&R":"CLIPVisionEncode"},"widgets_values":["center"]},{"id":74,"type":"ImageResize+","pos":[217.6936492919922,-778.368408203125],"size":[315,220],"flags":{},"order":10,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":251,"label":"图像"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[150,151],"slot_index":0,"label":"图像"},{"name":"width","type":"INT","links":null,"label":"宽度"},{"name":"height","type":"INT","links":null,"label":"高度"}],"properties":{"Node name for S&R":"ImageResize+"},"widgets_values":[1600,1600,"lanczos","keep proportion","always",0]},{"id":97,"type":"InpaintStitch","pos":[1625.78076171875,84],"size":[210,80],"flags":{},"order":26,"mode":0,"inputs":[{"name":"stitch","type":"STITCH","link":229,"label":"接缝"},{"name":"inpainted_image","type":"IMAGE","link":230,"label":"图像"}],"outputs":[{"name":"image","type":"IMAGE","links":[231,233],"slot_index":0,"label":"图像"}],"properties":{"Node name for S&R":"InpaintStitch"},"widgets_values":["bislerp"]},{"id":103,"type":"FaceDetailer","pos":[-227.5734405517578,957.6788330078125],"size":[520,1125],"flags":{},"order":28,"mode":4,"inputs":[{"name":"image","type":"IMAGE","link":233,"label":"图像"},{"name":"model","type":"MODEL","link":234,"label":"模型"},{"name":"clip","type":"CLIP","link":235,"label":"CLIP"},{"name":"vae","type":"VAE","link":236,"label":"VAE"},{"name":"positive","type":"CONDITIONING","link":237,"label":"正面条件"},{"name":"negative","type":"CONDITIONING","link":238,"label":"负面条件"},{"name":"bbox_detector","type":"BBOX_DETECTOR","link":239,"label":"BBox检测"},{"name":"sam_model_opt","type":"SAM_MODEL","link":240,"shape":7,"label":"SAM模型"},{"name":"segm_detector_opt","type":"SEGM_DETECTOR","link":null,"shape":7,"label":"Segm检测"},{"name":"detailer_hook","type":"DETAILER_HOOK","link":null,"shape":7,"label":"细化约束"},{"name":"scheduler_func_opt","type":"SCHEDULER_FUNC","link":null,"shape":7}],"outputs":[{"name":"image","type":"IMAGE","links":[241],"slot_index":0,"label":"图像"},{"name":"cropped_refined","type":"IMAGE","links":null,"shape":6,"label":"细化图像"},{"name":"cropped_enhanced_alpha","type":"IMAGE","links":null,"shape":6,"label":"细化部分"},{"name":"mask","type":"MASK","links":null,"label":"遮罩"},{"name":"detailer_pipe","type":"DETAILER_PIPE","links":null,"label":"细化节点束"},{"name":"cnet_images","type":"IMAGE","links":null,"shape":6,"label":"ControlNet图像"}],"properties":{"Node name for S&R":"FaceDetailer"},"widgets_values":[512,true,1024,39747815152390,"randomize",20,1,"euler","normal",0.5,5,true,true,0.5,10,3,"center-1",0,0.93,0,0.7,"False",10,"",1,false,20,[false,true]]},{"id":104,"type":"UltralyticsDetectorProvider","pos":[-203.57339477539062,814.6785278320312],"size":[315,80],"flags":{},"order":1,"mode":4,"inputs":[],"outputs":[{"name":"BBOX_DETECTOR","type":"BBOX_DETECTOR","links":[239],"slot_index":0,"label":"BBox检测"},{"name":"SEGM_DETECTOR","type":"SEGM_DETECTOR","links":null,"slot_index":1,"label":"SEGM检测"}],"properties":{"Node name for S&R":"UltralyticsDetectorProvider"},"widgets_values":["bbox/face_yolov8m.pt"]},{"id":105,"type":"SAMLoader","pos":[-203.57339477539062,694.6785278320312],"size":[315,82],"flags":{},"order":2,"mode":4,"inputs":[],"outputs":[{"name":"SAM_MODEL","type":"SAM_MODEL","links":[240],"label":"SAM模型"}],"properties":{"Node name for S&R":"SAMLoader"},"widgets_values":["sam_vit_b_01ec64.pth","AUTO"]},{"id":60,"type":"PreviewImage","pos":[602.6934204101562,-447.3681945800781],"size":[350,310],"flags":{},"order":19,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":135,"label":"图像"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":58,"type":"ImageConcanate","pos":[617.6934204101562,-667.368408203125],"size":[315,102],"flags":{},"order":17,"mode":0,"inputs":[{"name":"image1","type":"IMAGE","link":151,"label":"图像_1"},{"name":"image2","type":"IMAGE","link":125,"label":"图像_2"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[135,225,242,246],"slot_index":0,"label":"图像"}],"properties":{"Node name for S&R":"ImageConcanate"},"widgets_values":["right",true]},{"id":3,"type":"KSampler","pos":[1276.78076171875,-32],"size":[340,615],"flags":{},"order":24,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":86,"label":"模型"},{"name":"positive","type":"CONDITIONING","link":77,"label":"正面条件"},{"name":"negative","type":"CONDITIONING","link":78,"label":"负面条件"},{"name":"latent_image","type":"LATENT","link":88,"label":"Latent"}],"outputs":[{"name":"LATENT","type":"LATENT","links":[7],"slot_index":0,"label":"Latent"}],"properties":{"Node name for S&R":"KSampler"},"widgets_values":[602404685517046,"randomize",30,1,"euler","simple",1]},{"id":54,"type":"LoadImage","pos":[-208.30612182617188,-825.368408203125],"size":[315,315],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[251],"slot_index":0,"label":"图像"},{"name":"MASK","type":"MASK","links":null,"label":"遮罩"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["微信图片_20241210234758.png","image"],"color":"#346434"},{"id":56,"type":"StyleModelLoader","pos":[-178.46585083007812,389.6102600097656],"size":[340,60],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[{"name":"STYLE_MODEL","type":"STYLE_MODEL","links":[114],"label":"风格模型"}],"properties":{"Node name for S&R":"StyleModelLoader"},"widgets_values":["flux1-redux-dev.safetensors"]},{"id":52,"type":"CLIPVisionLoader","pos":[-187.4193878173828,287.7986755371094],"size":[370,60],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[{"name":"CLIP_VISION","type":"CLIP_VISION","links":[112],"slot_index":0,"label":"CLIP视觉"}],"properties":{"Node name for S&R":"CLIPVisionLoader"},"widgets_values":["sigclip_vision_patch14_384.safetensors"]},{"id":31,"type":"UNETLoader","pos":[575.781005859375,-25],"size":[315,82],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[{"name":"MODEL","type":"MODEL","links":[85,234],"slot_index":0,"label":"模型"}],"properties":{"Node name for S&R":"UNETLoader"},"widgets_values":["flux1-fill-dev.safetensors","default"]},{"id":55,"type":"StyleModelApply","pos":[188.79539489746094,402.41729736328125],"size":[328.8694763183594,122],"flags":{},"order":18,"mode":0,"inputs":[{"name":"conditioning","type":"CONDITIONING","link":116,"label":"条件"},{"name":"style_model","type":"STYLE_MODEL","link":114,"label":"风格模型"},{"name":"clip_vision_output","type":"CLIP_VISION_OUTPUT","link":115,"shape":7,"label":"CLIP视觉输出"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[117],"slot_index":0,"label":"条件"}],"properties":{"Node name for S&R":"StyleModelApply"},"widgets_values":[1,"multiply"]},{"id":101,"type":"InpaintCrop","pos":[596.0440673828125,203.25425720214844],"size":[310,386],"flags":{},"order":22,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":225,"label":"图像"},{"name":"mask","type":"MASK","link":243,"label":"遮罩"},{"name":"optional_context_mask","type":"MASK","link":247,"shape":7,"label":"上下文遮罩(可选)"}],"outputs":[{"name":"stitch","type":"STITCH","links":[229],"slot_index":0,"label":"接缝"},{"name":"cropped_image","type":"IMAGE","links":[227],"slot_index":1},{"name":"cropped_mask","type":"MASK","links":[228],"slot_index":2}],"properties":{"Node name for S&R":"InpaintCrop"},"widgets_values":[10,1,true,0,false,16,"bicubic","ranged size",1024,1024,1,512,512,1024,1024,32]},{"id":23,"type":"CLIPTextEncode","pos":[140.52676391601562,-27.23745346069336],"size":[425,165],"flags":{},"order":12,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":62,"label":"CLIP"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[41],"slot_index":0,"label":"条件"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["",true],"color":"#232","bgcolor":"#353"},{"id":34,"type":"DualCLIPLoader","pos":[-227.8460693359375,-15.356155395507812],"size":[315,106],"flags":{},"order":7,"mode":0,"inputs":[],"outputs":[{"name":"CLIP","type":"CLIP","links":[62,63,235],"slot_index":0,"label":"CLIP"}],"properties":{"Node name for S&R":"DualCLIPLoader"},"widgets_values":["clip_l.safetensors","t5xxl_fp16.safetensors","flux"]},{"id":102,"type":"PreviewImage","pos":[-1282.9635009765625,-808.4445190429688],"size":[1000,665],"flags":{},"order":27,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":231,"label":"图像"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":107,"type":"PreviewBridge","pos":[1112.256591796875,-820.5806884765625],"size":[588.1775512695312,338],"flags":{},"order":20,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":242,"label":"图像"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":null,"label":"图像"},{"name":"MASK","type":"MASK","links":[243],"slot_index":1,"label":"遮罩"}],"properties":{"Node name for S&R":"PreviewBridge"},"widgets_values":["$107-1733884269.2526128",false,"never"],"color":"#422342"},{"id":108,"type":"PreviewBridge","pos":[1113.650634765625,-451.5806884765625],"size":[592.3587646484375,338],"flags":{},"order":21,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":246,"label":"图像"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[],"slot_index":0,"label":"图像"},{"name":"MASK","type":"MASK","links":[247],"slot_index":1,"label":"遮罩"}],"properties":{"Node name for S&R":"PreviewBridge"},"widgets_values":["$108-1733884270.2526128",false,"never"],"color":"#422342"},{"id":106,"type":"PreviewImage","pos":[346.42657470703125,964.678955078125],"size":[1459.0128173828125,1164.1549072265625],"flags":{},"order":29,"mode":4,"inputs":[{"name":"images","type":"IMAGE","link":241,"label":"图像"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":112,"type":"Note","pos":[1179.363525390625,-1127.7548828125],"size":[434.0910339355469,205.64881896972656],"flags":{},"order":8,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["加载图像，上图为服装参考图，下图为模型图，加载后，先执行队列跑一次。\n\n报错后，在下面两张预览图中涂抹遮罩，上面的图涂抹右边模型的希望换的衣服遮罩，\n下面的图，涂抹左边的服装部分遮罩，用来参考迁移。\n\n涂抹后，再次执行队列。\n\n要注意所有模型加载位置，都需要检查一下模型是否正确。"],"color":"#432","bgcolor":"#653"},{"id":17,"type":"LoadImage","pos":[-207.30612182617188,-467.3681945800781],"size":[315,330],"flags":{},"order":9,"mode":0,"inputs":[],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[106],"slot_index":0,"shape":3,"label":"图像"},{"name":"MASK","type":"MASK","links":[],"slot_index":1,"shape":3,"label":"遮罩"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["ComfyUI_temp_uzgir_00031_.png","image"],"color":"#af3535"}],"links":[[7,3,0,8,0,"LATENT"],[41,23,0,26,0,"CONDITIONING"],[60,32,0,8,1,"VAE"],[62,34,0,23,0,"CLIP"],[63,34,0,7,0,"CLIP"],[77,38,0,3,1,"CONDITIONING"],[78,38,1,3,2,"CONDITIONING"],[81,7,0,38,1,"CONDITIONING"],[82,32,0,38,2,"VAE"],[85,31,0,39,0,"MODEL"],[86,39,0,3,0,"MODEL"],[88,38,2,3,3,"LATENT"],[106,17,0,49,0,"IMAGE"],[112,52,0,53,0,"CLIP_VISION"],[114,56,0,55,1,"STYLE_MODEL"],[115,53,0,55,2,"CLIP_VISION_OUTPUT"],[116,26,0,55,0,"CONDITIONING"],[117,55,0,38,0,"CONDITIONING"],[125,49,0,58,1,"IMAGE"],[135,58,0,60,0,"IMAGE"],[150,74,0,53,1,"IMAGE"],[151,74,0,58,0,"IMAGE"],[225,58,0,101,0,"IMAGE"],[227,101,1,38,3,"IMAGE"],[228,101,2,38,4,"MASK"],[229,101,0,97,0,"STITCH"],[230,8,0,97,1,"IMAGE"],[231,97,0,102,0,"IMAGE"],[233,97,0,103,0,"IMAGE"],[234,31,0,103,1,"MODEL"],[235,34,0,103,2,"CLIP"],[236,32,0,103,3,"VAE"],[237,26,0,103,4,"CONDITIONING"],[238,7,0,103,5,"CONDITIONING"],[239,104,0,103,6,"BBOX_DETECTOR"],[240,105,0,103,7,"SAM_MODEL"],[241,103,0,106,0,"IMAGE"],[242,58,0,107,0,"IMAGE"],[243,107,1,101,1,"MASK"],[246,58,0,108,0,"IMAGE"],[247,108,1,101,2,"MASK"],[251,54,0,74,0,"IMAGE"]],"groups":[{"id":3,"title":"生图","bounding":[-241.21908569335938,-105.5999984741211,2080.220703125,704.423095703125],"color":"#3f789e","font_size":24,"flags":{}},{"id":2,"title":"redux","bounding":[-208.46591186523438,208.0102996826172,774.1422729492188,351.697509765625],"color":"#3f789e","font_size":24,"flags":{}},{"id":4,"title":"加载","bounding":[-238.66567993164062,-898.5608520507812,2076.998291015625,786.7501220703125],"color":"#3f789e","font_size":24,"flags":{}},{"id":5,"title":"面部修复","bounding":[-237.5734405517578,621.0784301757812,2075.9404296875,1527.002685546875],"color":"#3f789e","font_size":24,"flags":{}}],"config":{"links_ontop":false},"extra":{"ds":{"scale":0.33809166040571054,"offset":[3572.72745396244,1931.908636907189]},"workspace_info":{"id":"b6876a05-b3a8-4fd9-9288-716e8e52b0a4","saveLock":false,"cloudID":null,"coverMediaPath":null},"ue_links":[]},"version":0.4}